<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #570002; -webkit-text-stroke: #570002}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #f6000b; -webkit-text-stroke: #f6000b}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #0000ff; -webkit-text-stroke: #0000ff}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; -webkit-text-stroke: #000000}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #175f20; -webkit-text-stroke: #175f20}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; -webkit-text-stroke: #000000; min-height: 16.0px}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px 'PingFang SC'; -webkit-text-stroke: #000000}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #3c3f43; -webkit-text-stroke: #3c3f43}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #91330c; -webkit-text-stroke: #91330c}
    p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #570002; -webkit-text-stroke: #570002; min-height: 16.0px}
    span.s1 {font-kerning: none; color: #1f1f1f; background-color: #e7edf5; -webkit-text-stroke: 0px #1f1f1f}
    span.s2 {font-kerning: none; background-color: #e7edf5}
    span.s3 {font-kerning: none; background-color: #e7edf5; -webkit-text-stroke: 0px #000000}
    span.s4 {font-kerning: none; color: #570002; background-color: #e7edf5; -webkit-text-stroke: 0px #570002}
    span.s5 {font-kerning: none; color: #0000ff; background-color: #e7edf5; -webkit-text-stroke: 0px #0000ff}
    span.s6 {font-kerning: none; color: #f6000b; background-color: #e7edf5; -webkit-text-stroke: 0px #f6000b}
    span.s7 {font: 14.0px 'PingFang SC'; font-kerning: none; background-color: #e7edf5}
    span.s8 {font-kerning: none; color: #156536; background-color: #e7edf5; -webkit-text-stroke: 0px #156536}
    span.s9 {font-kerning: none; color: #0b2981; background-color: #e7edf5; -webkit-text-stroke: 0px #0b2981}
    span.s10 {font-kerning: none}
    span.s11 {font: 14.0px Menlo; font-kerning: none; background-color: #e7edf5}
    span.s12 {font: 14.0px Menlo; font-kerning: none; color: #1f1f1f; background-color: #e7edf5; -webkit-text-stroke: 0px #1f1f1f}
    span.s13 {font: 14.0px Menlo; font-kerning: none; color: #570002; background-color: #e7edf5; -webkit-text-stroke: 0px #570002}
    span.s14 {font-kerning: none; color: #5a00b6; background-color: #e7edf5; -webkit-text-stroke: 0px #5a00b6}
    span.s15 {font-kerning: none; color: #91330c; background-color: #e7edf5; -webkit-text-stroke: 0px #91330c}
    span.s16 {font-kerning: none; color: #125c5a; background-color: #e7edf5; -webkit-text-stroke: 0px #125c5a}
    span.s17 {font-kerning: none; color: #175f20; background-color: #e7edf5; -webkit-text-stroke: 0px #175f20}
    span.s18 {font: 14.0px 'PingFang SC'; font-kerning: none; color: #175f20; background-color: #e7edf5; -webkit-text-stroke: 0px #175f20}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;</span><span class="s2">head</span><span class="s1">&gt;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;</span><span class="s4">meta</span><span class="s3"> </span><span class="s2">charset</span><span class="s1">=</span><span class="s5">"UTF-8"</span><span class="s1">&gt;</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;</span><span class="s4">meta</span><span class="s3"> </span><span class="s6">name</span><span class="s1">=</span><span class="s2">"viewport"</span><span class="s3"> </span><span class="s6">content</span><span class="s1">=</span><span class="s2">"width=device-width, initial-scale=1.0"</span><span class="s1">&gt;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;</span><span class="s4">title</span><span class="s1">&gt;</span><span class="s7">网红鸽子：</span><span class="s2">UwU Funk </span><span class="s7">热舞挑战</span><span class="s2"> - Designed by Laura</span><span class="s1">&lt;/</span><span class="s4">title</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;</span><span class="s2">style</span><span class="s1">&gt;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">body</span><span class="s2"> {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">margin:</span><span class="s2"> </span><span class="s8">0</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">overflow:</span><span class="s2"> </span><span class="s9">hidden</span><span class="s2">;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">            </span></span><span class="s2">background-color:</span><span class="s3"> </span><span class="s9">#B0E2FF</span><span class="s3">;<span class="Apple-converted-space"> </span></span></p>
<p class="p5"><span class="s3"><span class="Apple-converted-space">            </span></span><span class="s6">font-family:</span><span class="s3"> </span><span class="s2">'Arial Black'</span><span class="s3">, </span><span class="s2">'Microsoft YaHei'</span><span class="s3">, </span><span class="s9">sans-serif</span><span class="s3">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">display:</span><span class="s2"> </span><span class="s9">flex</span><span class="s2">;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">            </span></span><span class="s2">justify-content:</span><span class="s3"> </span><span class="s9">center</span><span class="s3">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">align-items:</span><span class="s2"> </span><span class="s9">center</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">height:</span><span class="s2"> </span><span class="s8">100vh</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">canvas</span><span class="s2"> {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">display:</span><span class="s2"> </span><span class="s9">block</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">cursor:</span><span class="s2"> </span><span class="s9">crosshair</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">#ui-layer</span><span class="s2"> {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">position:</span><span class="s2"> </span><span class="s9">absolute</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">top:</span><span class="s2"> </span><span class="s8">25px</span><span class="s2">;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">            </span></span><span class="s2">pointer-events:</span><span class="s3"> </span><span class="s9">none</span><span class="s3">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">text-align:</span><span class="s2"> </span><span class="s9">center</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">width:</span><span class="s2"> </span><span class="s8">100%</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">.score-box</span><span class="s2"> {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">display:</span><span class="s2"> </span><span class="s9">inline-block</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">background:</span><span class="s2"> </span><span class="s9">rgba(</span><span class="s8">255</span><span class="s2">, </span><span class="s8">255</span><span class="s2">, </span><span class="s8">255</span><span class="s2">, </span><span class="s8">0.95</span><span class="s9">)</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">padding:</span><span class="s2"> </span><span class="s8">10px</span><span class="s2"> </span><span class="s8">40px</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">border-radius:</span><span class="s2"> </span><span class="s8">50px</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">border:</span><span class="s2"> </span><span class="s8">4px</span><span class="s2"> </span><span class="s9">solid</span><span class="s2"> </span><span class="s9">#1e3799</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">box-shadow:</span><span class="s2"> </span><span class="s8">0</span><span class="s2"> </span><span class="s8">8px</span><span class="s2"> </span><span class="s8">20px</span><span class="s2"> </span><span class="s9">rgba(</span><span class="s8">0</span><span class="s2">,</span><span class="s8">0</span><span class="s2">,</span><span class="s8">0</span><span class="s2">,</span><span class="s8">0.2</span><span class="s9">)</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s2">.score-text</span><span class="s3"> {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">font-size:</span><span class="s2"> </span><span class="s8">36px</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">font-weight:</span><span class="s2"> </span><span class="s8">900</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">color:</span><span class="s2"> </span><span class="s9">#1e3799</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">#footer</span><span class="s2"> {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">position:</span><span class="s2"> </span><span class="s9">absolute</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">bottom:</span><span class="s2"> </span><span class="s8">20px</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">right:</span><span class="s2"> </span><span class="s8">20px</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">color:</span><span class="s2"> </span><span class="s9">#1e3799</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">font-size:</span><span class="s2"> </span><span class="s8">18px</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">font-weight:</span><span class="s2"> </span><span class="s9">bold</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">opacity:</span><span class="s2"> </span><span class="s8">0.8</span><span class="s2">;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">            </span></span><span class="s2">pointer-events:</span><span class="s3"> </span><span class="s9">none</span><span class="s3">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">text-shadow:</span><span class="s2"> </span><span class="s8">1px</span><span class="s2"> </span><span class="s8">1px</span><span class="s2"> </span><span class="s8">2px</span><span class="s2"> </span><span class="s9">white</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">#overlay</span><span class="s2"> {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">position:</span><span class="s2"> </span><span class="s9">absolute</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">width:</span><span class="s2"> </span><span class="s8">100%</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">height:</span><span class="s2"> </span><span class="s8">100%</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">background:</span><span class="s2"> </span><span class="s9">rgba(</span><span class="s8">0</span><span class="s2">, </span><span class="s8">0</span><span class="s2">, </span><span class="s8">0</span><span class="s2">, </span><span class="s8">0.9</span><span class="s9">)</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">display:</span><span class="s2"> </span><span class="s9">flex</span><span class="s2">;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">            </span></span><span class="s2">flex-direction:</span><span class="s3"> </span><span class="s9">column</span><span class="s3">;</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">            </span></span><span class="s2">justify-content:</span><span class="s3"> </span><span class="s9">center</span><span class="s3">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">align-items:</span><span class="s2"> </span><span class="s9">center</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">z-index:</span><span class="s2"> </span><span class="s8">100</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">color:</span><span class="s2"> </span><span class="s9">white</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">text-align:</span><span class="s2"> </span><span class="s9">center</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p2"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s4">#overlay</span><span class="s3"> </span><span class="s4">h1</span><span class="s3"> { </span><span class="s2">font-size:</span><span class="s3"> </span><span class="s8">60px</span><span class="s3">; </span><span class="s2">margin-bottom:</span><span class="s3"> </span><span class="s8">20px</span><span class="s3">; </span><span class="s2">color:</span><span class="s3"> </span><span class="s9">#FFD32A</span><span class="s3">; </span><span class="s2">text-shadow:</span><span class="s3"> </span><span class="s8">4px</span><span class="s3"> </span><span class="s8">4px</span><span class="s3"> </span><span class="s9">#1e3799</span><span class="s3">; }</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">#start-btn</span><span class="s2"> {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">padding:</span><span class="s2"> </span><span class="s8">20px</span><span class="s2"> </span><span class="s8">60px</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">font-size:</span><span class="s2"> </span><span class="s8">32px</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">background:</span><span class="s2"> </span><span class="s9">#2ecc71</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">color:</span><span class="s2"> </span><span class="s9">white</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">border:</span><span class="s2"> </span><span class="s9">none</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">border-radius:</span><span class="s2"> </span><span class="s8">50px</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">cursor:</span><span class="s2"> </span><span class="s9">pointer</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">box-shadow:</span><span class="s2"> </span><span class="s8">0</span><span class="s2"> </span><span class="s8">10px</span><span class="s2"> </span><span class="s8">0</span><span class="s2"> </span><span class="s9">#27ae60</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s6">transition:</span><span class="s2"> </span><span class="s8">0.1s</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s4">#start-btn:active</span><span class="s2"> { </span><span class="s6">transform:</span><span class="s2"> </span><span class="s9">translateY(</span><span class="s8">10px</span><span class="s9">)</span><span class="s2">; </span><span class="s6">box-shadow:</span><span class="s2"> </span><span class="s8">0</span><span class="s2"> </span><span class="s8">0</span><span class="s2"> </span><span class="s8">0</span><span class="s2"> </span><span class="s9">#27ae60</span><span class="s2">; }</span></p>
<p class="p1"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;/</span><span class="s2">style</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s1">&lt;/</span><span class="s2">head</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s1">&lt;</span><span class="s2">body</span><span class="s1">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;</span><span class="s4">div</span><span class="s3"> </span><span class="s6">id</span><span class="s1">=</span><span class="s2">"overlay"</span><span class="s1">&gt;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;</span><span class="s4">h1</span><span class="s1">&gt;</span><span class="s2">UWU FUNK PIGEON</span><span class="s1">&lt;/</span><span class="s4">h1</span><span class="s1">&gt;</span></p>
<p class="p7"><span class="s11"><span class="Apple-converted-space">        </span></span><span class="s12">&lt;</span><span class="s13">p</span><span class="s12">&gt;</span><span class="s2">跟着</span><span class="s11"> UwU Funk </span><span class="s2">的节奏掠袭玉米！</span><span class="s12">&lt;</span><span class="s13">br</span><span class="s12">&gt;</span><span class="s2">连续吃到</span><span class="s11"> 3 </span><span class="s2">次腐烂玉米可触发隐藏结局</span><span class="s12">&lt;</span><span class="s13">br</span><span class="s12">&gt;</span><span class="s2">分数为负将面临鸽子的终极嘲讽！</span><span class="s12">&lt;/</span><span class="s13">p</span><span class="s12">&gt;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;</span><span class="s4">button</span><span class="s2"> </span><span class="s6">id</span><span class="s1">=</span><span class="s5">"start-btn"</span><span class="s1">&gt;</span><span class="s7">开启</span><span class="s2"> UwU </span><span class="s7">热舞</span><span class="s1">&lt;/</span><span class="s4">button</span><span class="s1">&gt;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;/</span><span class="s4">div</span><span class="s1">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;</span><span class="s4">div</span><span class="s3"> </span><span class="s6">id</span><span class="s1">=</span><span class="s2">"ui-layer"</span><span class="s1">&gt;</span></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;</span><span class="s4">div</span><span class="s3"> </span><span class="s6">class</span><span class="s1">=</span><span class="s2">"score-box"</span><span class="s1">&gt;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s1">&lt;</span><span class="s4">span</span><span class="s2"> </span><span class="s6">class</span><span class="s1">=</span><span class="s5">"score-text"</span><span class="s1">&gt;</span><span class="s2">SCORE: </span><span class="s1">&lt;</span><span class="s4">span</span><span class="s2"> </span><span class="s6">id</span><span class="s1">=</span><span class="s5">"scoreVal"</span><span class="s1">&gt;</span><span class="s2">0</span><span class="s1">&lt;/</span><span class="s4">span</span><span class="s1">&gt;&lt;/</span><span class="s4">span</span><span class="s1">&gt;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s1">&lt;/</span><span class="s4">div</span><span class="s1">&gt;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;/</span><span class="s4">div</span><span class="s1">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;</span><span class="s4">div</span><span class="s2"> </span><span class="s6">id</span><span class="s1">=</span><span class="s5">"footer"</span><span class="s1">&gt;</span><span class="s2">Designed by Laura</span><span class="s1">&lt;/</span><span class="s4">div</span><span class="s1">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p3"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;</span><span class="s4">canvas</span><span class="s3"> </span><span class="s6">id</span><span class="s1">=</span><span class="s2">"gameCanvas"</span><span class="s1">&gt;&lt;/</span><span class="s4">canvas</span><span class="s1">&gt;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p1"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;</span><span class="s2">script</span><span class="s1">&gt;</span></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s2">/** --- </span><span class="s7">音频引擎：</span><span class="s2">UwU Funk </span><span class="s7">节奏同步</span><span class="s2"> --- **/</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">let</span><span class="s2"> audioCtx;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">let</span><span class="s2"> masterGain;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">let</span><span class="s2"> currentStep = </span><span class="s15">0</span><span class="s2">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">function</span><span class="s2"> initAudio() {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">if</span><span class="s2">(audioCtx) </span><span class="s14">return</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>audioCtx = </span><span class="s14">new</span><span class="s2"> (window.</span><span class="s16">AudioContext</span><span class="s2"> || window.webkitAudioContext)();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>masterGain = audioCtx.createGain();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>masterGain.connect(audioCtx.destination);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>masterGain.gain.value = </span><span class="s15">0.4</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>playHyperFunk();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">function</span><span class="s2"> playSound(freq, type, duration, vol = </span><span class="s15">0.3</span><span class="s2">, slide = </span><span class="s14">false</span><span class="s2">) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">if</span><span class="s2">(!audioCtx) </span><span class="s14">return</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> osc = audioCtx.createOscillator();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> g = audioCtx.createGain();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>osc.type = type;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>osc.frequency.setValueAtTime(freq, audioCtx.currentTime);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">if</span><span class="s2">(slide) osc.frequency.exponentialRampToValueAtTime(freq * </span><span class="s15">0.4</span><span class="s2">, audioCtx.currentTime + duration);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>g.gain.setValueAtTime(vol, audioCtx.currentTime);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>g.gain.exponentialRampToValueAtTime(</span><span class="s15">0.01</span><span class="s2">, audioCtx.currentTime + duration);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>osc.connect(g);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>g.connect(masterGain);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>osc.start();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>osc.stop(audioCtx.currentTime + duration);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s2">// </span><span class="s7">定义失败音效</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">function</span><span class="s2"> playLoudFailSound() {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">if</span><span class="s2">(!audioCtx) </span><span class="s14">return</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">for</span><span class="s2">(</span><span class="s14">let</span><span class="s2"> i=</span><span class="s15">0</span><span class="s2">; i&lt;</span><span class="s15">5</span><span class="s2">; i++) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>playSound(</span><span class="s15">50</span><span class="s2"> + i*</span><span class="s15">15</span><span class="s2">, </span><span class="s17">'sawtooth'</span><span class="s2">, </span><span class="s15">1.5</span><span class="s2">, </span><span class="s15">0.9</span><span class="s2">, </span><span class="s14">true</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>playSound(</span><span class="s15">30</span><span class="s2"> + i*</span><span class="s15">10</span><span class="s2">, </span><span class="s17">'square'</span><span class="s2">, </span><span class="s15">1.2</span><span class="s2">, </span><span class="s15">0.6</span><span class="s2">, </span><span class="s14">true</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s2">// </span><span class="s7">滑稽洪亮的中文配音</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">function</span><span class="s2"> speakFail() {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> utter = </span><span class="s14">new</span><span class="s2"> </span><span class="s16">SpeechSynthesisUtterance</span><span class="s2">(</span><span class="s17">"</span><span class="s18">你也太菜了</span><span class="s17">"</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>utter.lang = </span><span class="s17">'zh-CN'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>utter.pitch = </span><span class="s15">2.0</span><span class="s2">;<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>utter.rate = </span><span class="s15">1.3</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>utter.volume = </span><span class="s15">1.0</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>window.speechSynthesis.speak(utter);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">function</span><span class="s2"> playHyperFunk() {</span></p>
<p class="p9"><span class="s3"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s3"> bass = [</span><span class="s2">73.42</span><span class="s3">, </span><span class="s2">73.42</span><span class="s3">, </span><span class="s2">98.00</span><span class="s3">, </span><span class="s2">110.00</span><span class="s3">, </span><span class="s2">116.54</span><span class="s3">, </span><span class="s2">110.00</span><span class="s3">, </span><span class="s2">98.00</span><span class="s3">, </span><span class="s2">82.41</span><span class="s3">];<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>setInterval(() =&gt; {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">if</span><span class="s2">(gameState === </span><span class="s17">'IDLE'</span><span class="s2">) </span><span class="s14">return</span><span class="s2">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">if</span><span class="s2">(currentStep % </span><span class="s15">4</span><span class="s2"> === </span><span class="s15">0</span><span class="s2">) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>playSound(bass[</span><span class="s16">Math</span><span class="s2">.floor(currentStep/</span><span class="s15">4</span><span class="s2">) % bass.length], </span><span class="s17">'triangle'</span><span class="s2">, </span><span class="s15">0.2</span><span class="s2">, </span><span class="s15">0.7</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>playSound(</span><span class="s15">40</span><span class="s2">, </span><span class="s17">'sine'</span><span class="s2">, </span><span class="s15">0.2</span><span class="s2">, </span><span class="s15">0.9</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">if</span><span class="s2">(currentStep % </span><span class="s15">8</span><span class="s2"> === </span><span class="s15">4</span><span class="s2">) playSound(</span><span class="s15">200</span><span class="s2">, </span><span class="s17">'sawtooth'</span><span class="s2">, </span><span class="s15">0.1</span><span class="s2">, </span><span class="s15">0.3</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">if</span><span class="s2">(currentStep % </span><span class="s15">16</span><span class="s2"> === </span><span class="s15">12</span><span class="s2">) playSound(</span><span class="s15">1400</span><span class="s2">, </span><span class="s17">'square'</span><span class="s2">, </span><span class="s15">0.1</span><span class="s2">, </span><span class="s15">0.1</span><span class="s2">, </span><span class="s14">true</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>currentStep++;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>}, </span><span class="s15">120</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p8"><span class="s3"><span class="Apple-converted-space">        </span></span><span class="s2">/** --- </span><span class="s7">游戏核心逻辑</span><span class="s2"> --- **/</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">const</span><span class="s2"> canvas = document.getElementById(</span><span class="s17">'gameCanvas'</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">const</span><span class="s2"> ctx = canvas.getContext(</span><span class="s17">'2d'</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">const</span><span class="s2"> scoreEl = document.getElementById(</span><span class="s17">'scoreVal'</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">const</span><span class="s2"> overlay = document.getElementById(</span><span class="s17">'overlay'</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">const</span><span class="s2"> startBtn = document.getElementById(</span><span class="s17">'start-btn'</span><span class="s2">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">let</span><span class="s2"> width, height;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">let</span><span class="s2"> score = </span><span class="s15">0</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">let</span><span class="s2"> rottenStreak = </span><span class="s15">0</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">let</span><span class="s2"> gameState = </span><span class="s17">'IDLE'</span><span class="s2">;<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">let</span><span class="s2"> kernels = [];</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">let</span><span class="s2"> windLines = [];</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">const</span><span class="s2"> pigeon = {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>x: </span><span class="s15">0</span><span class="s2">, y: </span><span class="s15">0</span><span class="s2">,</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>angle: </span><span class="s15">0</span><span class="s2">,</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>bankAngle: </span><span class="s15">0</span><span class="s2">,</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>z: </span><span class="s15">0</span><span class="s2">,</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>headBob: </span><span class="s15">0</span><span class="s2">,</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>wingPhase: </span><span class="s15">0</span><span class="s2">,</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>orbitAngle: </span><span class="s15">0</span><span class="s2">,</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>targetKernel: </span><span class="s14">null</span><span class="s2">,</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>orbitRadius: </span><span class="s15">280</span><span class="s2">,</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>buttShake: </span><span class="s15">0</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">function</span><span class="s2"> resize() {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>width = canvas.width = window.innerWidth;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>height = canvas.height = window.innerHeight;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>initKernels();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">function</span><span class="s2"> initKernels() {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>kernels = [];</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> centerX = width / </span><span class="s15">2</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> centerY = height / </span><span class="s15">2</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> totalCount = </span><span class="s15">16</span><span class="s2">;<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> rottenNum = </span><span class="s15">5</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> wormNum = </span><span class="s15">3</span><span class="s2">;<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> rottenIndices = </span><span class="s14">new</span><span class="s2"> </span><span class="s16">Set</span><span class="s2">();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">while</span><span class="s2">(rottenIndices.size &lt; rottenNum) rottenIndices.add(</span><span class="s16">Math</span><span class="s2">.floor(</span><span class="s16">Math</span><span class="s2">.random() * totalCount));</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> rottenArray = </span><span class="s16">Array</span><span class="s2">.</span><span class="s14">from</span><span class="s2">(rottenIndices);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> wormIndices = </span><span class="s14">new</span><span class="s2"> </span><span class="s16">Set</span><span class="s2">();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">while</span><span class="s2">(wormIndices.size &lt; </span><span class="s16">Math</span><span class="s2">.min(wormNum, rottenNum)) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>wormIndices.add(rottenArray[</span><span class="s16">Math</span><span class="s2">.floor(</span><span class="s16">Math</span><span class="s2">.random() * rottenArray.length)]);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">for</span><span class="s2">(</span><span class="s14">let</span><span class="s2"> i=</span><span class="s15">0</span><span class="s2">; i&lt;totalCount; i++) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> angle = (i / totalCount) * </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2"> * </span><span class="s15">2</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>kernels.push({</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>x: centerX + </span><span class="s16">Math</span><span class="s2">.cos(angle) * </span><span class="s15">145</span><span class="s2">,</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>y: centerY + </span><span class="s16">Math</span><span class="s2">.sin(angle) * </span><span class="s15">145</span><span class="s2">,</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>angle: angle,</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>isRotten: rottenIndices.has(i),</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>hasWorm: wormIndices.has(i),</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>eaten: </span><span class="s14">false</span><span class="s2">,</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>wormOffset: </span><span class="s16">Math</span><span class="s2">.random() * </span><span class="s15">10</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>startBtn.onclick = () =&gt; {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>overlay.style.display = </span><span class="s17">'none'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>gameState = </span><span class="s17">'PLAY'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>initAudio();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>};</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>window.addEventListener(</span><span class="s17">'resize'</span><span class="s2">, resize);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>resize();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>canvas.addEventListener(</span><span class="s17">'mousedown'</span><span class="s2">, () =&gt; {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">if</span><span class="s2">(gameState === </span><span class="s17">'PLAY'</span><span class="s2">) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> available = kernels.filter(k =&gt; !k.eaten);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">if</span><span class="s2">(available.length &gt; </span><span class="s15">0</span><span class="s2">) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s14">let</span><span class="s2"> closest = available[</span><span class="s15">0</span><span class="s2">];</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s14">let</span><span class="s2"> minDist = </span><span class="s16">Math</span><span class="s2">.hypot(closest.x - pigeon.x, closest.y - pigeon.y);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>available.forEach(k =&gt; {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s14">let</span><span class="s2"> d = </span><span class="s16">Math</span><span class="s2">.hypot(k.x - pigeon.x, k.y - pigeon.y);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s14">if</span><span class="s2">(d &lt; minDist) { minDist = d; closest = k; }</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>});</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>pigeon.targetKernel = closest;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>gameState = </span><span class="s17">'DIVE'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>playSound(</span><span class="s15">1000</span><span class="s2">, </span><span class="s17">'sine'</span><span class="s2">, </span><span class="s15">0.2</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>} </span><span class="s14">else</span><span class="s2"> </span><span class="s14">if</span><span class="s2"> ([</span><span class="s17">'RESULT'</span><span class="s2">, </span><span class="s17">'FAIL'</span><span class="s2">, </span><span class="s17">'HIDDEN'</span><span class="s2">].includes(gameState)) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>score = </span><span class="s15">0</span><span class="s2">; rottenStreak = </span><span class="s15">0</span><span class="s2">; scoreEl.innerText = </span><span class="s15">0</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>initKernels(); gameState = </span><span class="s17">'PLAY'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">function</span><span class="s2"> drawFeatherTexture(ctx, x, y, size) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.strokeStyle = </span><span class="s17">'rgba(0,0,0,0.06)'</span><span class="s2">; ctx.lineWidth = </span><span class="s15">1</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">for</span><span class="s2">(</span><span class="s14">let</span><span class="s2"> i=</span><span class="s15">0</span><span class="s2">; i&lt;</span><span class="s15">3</span><span class="s2">; i++) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.arc(x - i*</span><span class="s15">8</span><span class="s2">, y + i*</span><span class="s15">4</span><span class="s2">, size/</span><span class="s15">2.5</span><span class="s2">, </span><span class="s15">0.5</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2"> - </span><span class="s15">0.5</span><span class="s2">); ctx.stroke();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">function</span><span class="s2"> drawPigeon(x, y, angle, state) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.save();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.translate(x, y);</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> isDancing = (state === </span><span class="s17">'RESULT'</span><span class="s2"> || state === </span><span class="s17">'FAIL'</span><span class="s2"> || state === </span><span class="s17">'HIDDEN'</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> isDiving = state === </span><span class="s17">'DIVE'</span><span class="s2">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> </span><span class="s16">COL_BLUE</span><span class="s2"> = </span><span class="s17">"#3b67bf"</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> </span><span class="s16">COL_CHEST</span><span class="s2"> = </span><span class="s17">"#8ab1ff"</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> </span><span class="s16">COL_NECK</span><span class="s2"> = </span><span class="s17">"#8e44ad"</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> </span><span class="s16">COL_WINGS</span><span class="s2"> = </span><span class="s17">"#ecf0f1"</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> </span><span class="s16">COL_LEG</span><span class="s2"> = </span><span class="s17">"#ff7979"</span><span class="s2">;</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">if</span><span class="s2">(isDancing) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> beat = currentStep % </span><span class="s15">4</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> bounce = (beat === </span><span class="s15">0</span><span class="s2"> ? </span><span class="s15">50</span><span class="s2"> : </span><span class="s15">0</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> shake = </span><span class="s16">Math</span><span class="s2">.sin(currentStep * </span><span class="s15">0.9</span><span class="s2">) * (state === </span><span class="s17">'HIDDEN'</span><span class="s2"> ? </span><span class="s15">100</span><span class="s2"> : </span><span class="s15">60</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">                </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">if</span><span class="s2">(state === </span><span class="s17">'HIDDEN'</span><span class="s2">) ctx.scale(</span><span class="s15">1.6</span><span class="s2">, </span><span class="s15">1.6</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.translate(</span><span class="s15">0</span><span class="s2">, -bounce);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">'rgba(0,0,0,0.1)'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.ellipse(</span><span class="s15">0</span><span class="s2">, </span><span class="s15">130</span><span class="s2"> + bounce, </span><span class="s15">75</span><span class="s2">, </span><span class="s15">18</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.strokeStyle = </span><span class="s16">COL_LEG</span><span class="s2">; ctx.lineWidth = </span><span class="s15">3</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.moveTo(-</span><span class="s15">20</span><span class="s2">, </span><span class="s15">50</span><span class="s2">); ctx.lineTo(-</span><span class="s15">25</span><span class="s2">, </span><span class="s15">130</span><span class="s2">); ctx.stroke();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.moveTo(</span><span class="s15">20</span><span class="s2">, </span><span class="s15">50</span><span class="s2">); ctx.lineTo(</span><span class="s15">25</span><span class="s2">, </span><span class="s15">130</span><span class="s2">); ctx.stroke();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s16">COL_BLUE</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.ellipse(shake, </span><span class="s15">20</span><span class="s2">, </span><span class="s15">85</span><span class="s2">, </span><span class="s15">75</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2"> * </span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>drawFeatherTexture(ctx, shake, </span><span class="s15">20</span><span class="s2">, </span><span class="s15">80</span><span class="s2">);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s16">COL_BLUE</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.ellipse(</span><span class="s15">0</span><span class="s2">, </span><span class="s15">5</span><span class="s2">, </span><span class="s15">62</span><span class="s2">, </span><span class="s15">78</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2"> * </span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s16">COL_CHEST</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.ellipse(</span><span class="s15">0</span><span class="s2">, </span><span class="s15">15</span><span class="s2">, </span><span class="s15">42</span><span class="s2">, </span><span class="s15">52</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2"> * </span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s16">COL_NECK</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.ellipse(</span><span class="s15">0</span><span class="s2">, -</span><span class="s15">65</span><span class="s2">, </span><span class="s15">32</span><span class="s2">, </span><span class="s15">45</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2"> * </span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s16">COL_BLUE</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.arc(</span><span class="s15">0</span><span class="s2">, -</span><span class="s15">110</span><span class="s2">, </span><span class="s15">35</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2"> * </span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">'#f39c12'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.arc(-</span><span class="s15">16</span><span class="s2">, -</span><span class="s15">118</span><span class="s2">, </span><span class="s15">12</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.arc(</span><span class="s15">16</span><span class="s2">, -</span><span class="s15">118</span><span class="s2">, </span><span class="s15">12</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">'black'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> eyeTremor = </span><span class="s16">Math</span><span class="s2">.sin(currentStep * </span><span class="s15">1.5</span><span class="s2">) * (state === </span><span class="s17">'FAIL'</span><span class="s2"> ? </span><span class="s15">8</span><span class="s2"> : </span><span class="s15">3</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.arc(-</span><span class="s15">16</span><span class="s2"> + eyeTremor, -</span><span class="s15">118</span><span class="s2">, </span><span class="s15">6</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.arc(</span><span class="s15">16</span><span class="s2"> + eyeTremor, -</span><span class="s15">118</span><span class="s2">, </span><span class="s15">6</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">'#f1c40f'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.moveTo(-</span><span class="s15">8</span><span class="s2">, -</span><span class="s15">102</span><span class="s2">); ctx.lineTo(</span><span class="s15">0</span><span class="s2">, -</span><span class="s15">82</span><span class="s2">); ctx.lineTo(</span><span class="s15">8</span><span class="s2">, -</span><span class="s15">102</span><span class="s2">); ctx.fill();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>} </span><span class="s14">else</span><span class="s2"> {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.scale(</span><span class="s15">1</span><span class="s2"> + pigeon.z * </span><span class="s15">0.5</span><span class="s2">, </span><span class="s15">1</span><span class="s2"> + pigeon.z * </span><span class="s15">0.5</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.rotate(angle);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">if</span><span class="s2"> (isDiving) ctx.rotate(</span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">/</span><span class="s15">2</span><span class="s2">); </span><span class="s14">else</span><span class="s2"> ctx.rotate(pigeon.bankAngle);</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.save();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">if</span><span class="s2">(!isDiving) ctx.rotate(-angle - pigeon.bankAngle); </span><span class="s14">else</span><span class="s2"> ctx.rotate(-angle - </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">/</span><span class="s15">2</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">`rgba(0,0,0,</span><span class="s2">${</span><span class="s15">0.2</span><span class="s2"> - pigeon.z*</span><span class="s15">0.1</span><span class="s2">}</span><span class="s17">)`</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.ellipse(</span><span class="s15">0</span><span class="s2">, </span><span class="s15">95</span><span class="s2"> + pigeon.z*</span><span class="s15">30</span><span class="s2">, </span><span class="s15">75</span><span class="s2">, </span><span class="s15">18</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.restore();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.strokeStyle = </span><span class="s16">COL_LEG</span><span class="s2">; ctx.lineWidth = </span><span class="s15">2.5</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.moveTo(</span><span class="s15">0</span><span class="s2">, </span><span class="s15">15</span><span class="s2">); ctx.lineTo(-</span><span class="s15">12</span><span class="s2">, </span><span class="s15">38</span><span class="s2">); ctx.stroke();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.moveTo(</span><span class="s15">12</span><span class="s2">, </span><span class="s15">15</span><span class="s2">); ctx.lineTo(</span><span class="s15">12</span><span class="s2">, </span><span class="s15">38</span><span class="s2">); ctx.stroke();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s16">COL_BLUE</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.ellipse(-</span><span class="s15">45</span><span class="s2">, </span><span class="s15">8</span><span class="s2">, </span><span class="s15">78</span><span class="s2">, </span><span class="s15">62</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2"> * </span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.save(); ctx.translate(</span><span class="s15">0</span><span class="s2">, -</span><span class="s15">35</span><span class="s2">); ctx.fillStyle = </span><span class="s16">COL_WINGS</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> flap = </span><span class="s16">Math</span><span class="s2">.sin(pigeon.wingPhase);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>[-</span><span class="s15">1</span><span class="s2">, </span><span class="s15">1</span><span class="s2">].forEach(s =&gt; {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>ctx.save(); ctx.scale(</span><span class="s15">1</span><span class="s2">, s); ctx.rotate(flap * (isDiving?</span><span class="s15">1.4</span><span class="s2">:</span><span class="s15">0.6</span><span class="s2">));</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>ctx.beginPath(); ctx.moveTo(</span><span class="s15">0</span><span class="s2">,</span><span class="s15">0</span><span class="s2">); ctx.bezierCurveTo(-</span><span class="s15">25</span><span class="s2">,-</span><span class="s15">90</span><span class="s2">,-</span><span class="s15">130</span><span class="s2">,-</span><span class="s15">70</span><span class="s2">,-</span><span class="s15">80</span><span class="s2">,</span><span class="s15">25</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>ctx.restore();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>});</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.restore();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> bodyGrad = ctx.createRadialGradient(</span><span class="s15">0</span><span class="s2">,</span><span class="s15">0</span><span class="s2">,</span><span class="s15">5</span><span class="s2">,</span><span class="s15">0</span><span class="s2">,</span><span class="s15">0</span><span class="s2">,</span><span class="s15">85</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>bodyGrad.addColorStop(</span><span class="s15">0</span><span class="s2">, </span><span class="s16">COL_CHEST</span><span class="s2">); bodyGrad.addColorStop(</span><span class="s15">1</span><span class="s2">, </span><span class="s16">COL_BLUE</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = bodyGrad;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.ellipse(</span><span class="s15">25</span><span class="s2">, </span><span class="s15">5</span><span class="s2">, </span><span class="s15">68</span><span class="s2">, </span><span class="s15">52</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2"> * </span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.save(); ctx.translate(</span><span class="s15">65</span><span class="s2"> + pigeon.headBob, -</span><span class="s15">15</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s16">COL_NECK</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.ellipse(</span><span class="s15">0</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s15">28</span><span class="s2">, </span><span class="s15">42</span><span class="s2">, </span><span class="s15">0.3</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2"> * </span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s16">COL_BLUE</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.arc(</span><span class="s15">15</span><span class="s2">, -</span><span class="s15">30</span><span class="s2">, </span><span class="s15">30</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2"> * </span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">'#f39c12'</span><span class="s2">; ctx.beginPath(); ctx.arc(</span><span class="s15">35</span><span class="s2">,-</span><span class="s15">38</span><span class="s2">,</span><span class="s15">13</span><span class="s2">,</span><span class="s15">0</span><span class="s2">,</span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">'black'</span><span class="s2">; ctx.beginPath(); ctx.arc(</span><span class="s15">38</span><span class="s2">,-</span><span class="s15">38</span><span class="s2">,</span><span class="s15">7</span><span class="s2">,</span><span class="s15">0</span><span class="s2">,</span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">'#f1c40f'</span><span class="s2">; ctx.beginPath(); ctx.moveTo(</span><span class="s15">45</span><span class="s2">,-</span><span class="s15">30</span><span class="s2">); ctx.lineTo(</span><span class="s15">80</span><span class="s2">,-</span><span class="s15">25</span><span class="s2">); ctx.lineTo(</span><span class="s15">45</span><span class="s2">,-</span><span class="s15">20</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.restore();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.restore();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">function</span><span class="s2"> drawCorn() {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> cx = width / </span><span class="s15">2</span><span class="s2">, cy = height / </span><span class="s15">2</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.save();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> g = ctx.createRadialGradient(cx, cy, </span><span class="s15">5</span><span class="s2">, cx, cy, </span><span class="s15">125</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>g.addColorStop(</span><span class="s15">0</span><span class="s2">, </span><span class="s17">'#FFFBE6'</span><span class="s2">); g.addColorStop(</span><span class="s15">0.2</span><span class="s2">, </span><span class="s17">'#FFF59D'</span><span class="s2">); g.addColorStop(</span><span class="s15">0.85</span><span class="s2">, </span><span class="s17">'#FBC02D'</span><span class="s2">); g.addColorStop(</span><span class="s15">1</span><span class="s2">, </span><span class="s17">'#8D6E63'</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.fillStyle = g;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.beginPath(); ctx.arc(cx, cy, </span><span class="s15">120</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.strokeStyle = </span><span class="s17">'rgba(139, 69, 19, 0.15)'</span><span class="s2">; ctx.lineWidth = </span><span class="s15">1.2</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">for</span><span class="s2">(</span><span class="s14">let</span><span class="s2"> i=</span><span class="s15">0</span><span class="s2">; i&lt;</span><span class="s15">60</span><span class="s2">; i++) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> a = (i/</span><span class="s15">60</span><span class="s2">)*</span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> r1 = </span><span class="s15">15</span><span class="s2"> + </span><span class="s16">Math</span><span class="s2">.random()*</span><span class="s15">25</span><span class="s2">; </span><span class="s14">const</span><span class="s2"> r2 = </span><span class="s15">80</span><span class="s2"> + </span><span class="s16">Math</span><span class="s2">.random()*</span><span class="s15">35</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.beginPath(); ctx.moveTo(cx+</span><span class="s16">Math</span><span class="s2">.cos(a)*r1, cy+</span><span class="s16">Math</span><span class="s2">.sin(a)*r1); ctx.lineTo(cx+</span><span class="s16">Math</span><span class="s2">.cos(a)*r2, cy+</span><span class="s16">Math</span><span class="s2">.sin(a)*r2); ctx.stroke();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.restore();</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>kernels.forEach(k =&gt; {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">if</span><span class="s2">(!k.eaten) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>ctx.save(); ctx.translate(k.x, k.y); ctx.rotate(k.angle + </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">/</span><span class="s15">2</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s14">if</span><span class="s2">(k.isRotten) ctx.fillStyle = </span><span class="s17">'#3E2723'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s14">else</span><span class="s2"> {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s14">const</span><span class="s2"> kg = ctx.createRadialGradient(-</span><span class="s15">8</span><span class="s2">, -</span><span class="s15">15</span><span class="s2">, </span><span class="s15">3</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s15">32</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>kg.addColorStop(</span><span class="s15">0</span><span class="s2">, </span><span class="s17">'#FFFFFF'</span><span class="s2">); kg.addColorStop(</span><span class="s15">1</span><span class="s2">, </span><span class="s17">'#FBC02D'</span><span class="s2">); ctx.fillStyle = kg;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>ctx.beginPath(); ctx.ellipse(</span><span class="s15">0</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s15">28</span><span class="s2">, </span><span class="s15">38</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">                    </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s14">if</span><span class="s2">(k.hasWorm &amp;&amp; k.isRotten) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>ctx.fillStyle = </span><span class="s17">'rgba(0,0,0,0.6)'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>ctx.beginPath(); ctx.ellipse(</span><span class="s15">0</span><span class="s2">, </span><span class="s15">5</span><span class="s2">, </span><span class="s15">15</span><span class="s2">, </span><span class="s15">15</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">); ctx.fill();<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>ctx.save();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s14">const</span><span class="s2"> ws = </span><span class="s16">Math</span><span class="s2">.sin(</span><span class="s16">Date</span><span class="s2">.now()*</span><span class="s15">0.012</span><span class="s2"> + k.wormOffset) * </span><span class="s15">15</span><span class="s2"> - </span><span class="s15">5</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>ctx.fillStyle = </span><span class="s17">'#7bed9f'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s14">for</span><span class="s2">(</span><span class="s14">let</span><span class="s2"> i=</span><span class="s15">0</span><span class="s2">; i&lt;</span><span class="s15">3</span><span class="s2">; i++) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s14">const</span><span class="s2"> segY = ws + i*</span><span class="s15">10</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                            </span></span><span class="s14">if</span><span class="s2">(segY &lt; </span><span class="s15">12</span><span class="s2">) { ctx.beginPath(); ctx.arc(-</span><span class="s15">6</span><span class="s2"> + i*</span><span class="s15">6</span><span class="s2">, segY, </span><span class="s15">8</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">); ctx.fill(); }</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>ctx.fillStyle = </span><span class="s17">'white'</span><span class="s2">; ctx.beginPath(); ctx.arc(</span><span class="s15">6</span><span class="s2">, ws-</span><span class="s15">5</span><span class="s2">, </span><span class="s15">3.5</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>ctx.fillStyle = </span><span class="s17">'black'</span><span class="s2">; ctx.beginPath(); ctx.arc(</span><span class="s15">7</span><span class="s2">, ws-</span><span class="s15">5</span><span class="s2">, </span><span class="s15">1.5</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, </span><span class="s16">Math</span><span class="s2">.</span><span class="s16">PI</span><span class="s2">*</span><span class="s15">2</span><span class="s2">); ctx.fill();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>ctx.restore();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>ctx.restore();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>});</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">function</span><span class="s2"> update() {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">if</span><span class="s2">(gameState === </span><span class="s17">'PLAY'</span><span class="s2">) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>pigeon.z *= </span><span class="s15">0.88</span><span class="s2">;<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>pigeon.orbitAngle += </span><span class="s15">0.028</span><span class="s2">; pigeon.bankAngle = </span><span class="s15">0.22</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> tx = width/</span><span class="s15">2</span><span class="s2"> + </span><span class="s16">Math</span><span class="s2">.cos(pigeon.orbitAngle) * pigeon.orbitRadius;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> ty = height/</span><span class="s15">2</span><span class="s2"> + </span><span class="s16">Math</span><span class="s2">.sin(pigeon.orbitAngle) * pigeon.orbitRadius;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>pigeon.x += (tx - pigeon.x) * </span><span class="s15">0.2</span><span class="s2">; pigeon.y += (ty - pigeon.y) * </span><span class="s15">0.2</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>pigeon.angle = </span><span class="s16">Math</span><span class="s2">.atan2(ty - pigeon.y, tx - pigeon.x);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>pigeon.headBob = </span><span class="s16">Math</span><span class="s2">.sin(</span><span class="s16">Date</span><span class="s2">.now() * </span><span class="s15">0.01</span><span class="s2">) * </span><span class="s15">10</span><span class="s2">; pigeon.wingPhase += </span><span class="s15">0.35</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>}<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">else</span><span class="s2"> </span><span class="s14">if</span><span class="s2">(gameState === </span><span class="s17">'DIVE'</span><span class="s2">) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> k = pigeon.targetKernel;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> dx = k.x - pigeon.x, dy = k.y - pigeon.y;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">const</span><span class="s2"> dist = </span><span class="s16">Math</span><span class="s2">.hypot(dx, dy);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>pigeon.z = </span><span class="s16">Math</span><span class="s2">.min(</span><span class="s15">1</span><span class="s2">, pigeon.z + </span><span class="s15">0.15</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>pigeon.angle = </span><span class="s16">Math</span><span class="s2">.atan2(dy, dx);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>pigeon.wingPhase += </span><span class="s15">1.5</span><span class="s2">;<span class="Apple-converted-space"> </span></span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">if</span><span class="s2">(dist &gt; </span><span class="s15">25</span><span class="s2">) { pigeon.x += dx * </span><span class="s15">0.45</span><span class="s2">; pigeon.y += dy * </span><span class="s15">0.45</span><span class="s2">; }<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span></span><span class="s14">else</span><span class="s2"> {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>k.eaten = </span><span class="s14">true</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s14">if</span><span class="s2">(k.isRotten || k.hasWorm) {<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>score -= (k.hasWorm ? </span><span class="s15">2</span><span class="s2"> : </span><span class="s15">1</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>rottenStreak++;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>playSound(</span><span class="s15">80</span><span class="s2">, </span><span class="s17">'triangle'</span><span class="s2">, </span><span class="s15">0.8</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s14">if</span><span class="s2">(rottenStreak &gt;= </span><span class="s15">3</span><span class="s2"> &amp;&amp; score &gt;= </span><span class="s15">0</span><span class="s2">) { gameState = </span><span class="s17">'HIDDEN'</span><span class="s2">; </span><span class="s14">return</span><span class="s2">; }</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>} </span><span class="s14">else</span><span class="s2"> {<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>score += </span><span class="s15">1</span><span class="s2">; rottenStreak = </span><span class="s15">0</span><span class="s2">; playSound(</span><span class="s15">1400</span><span class="s2">, </span><span class="s17">'sine'</span><span class="s2">, </span><span class="s15">0.15</span><span class="s2">);<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>scoreEl.innerText = score;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span></span><span class="s14">if</span><span class="s2">(score &lt; </span><span class="s15">0</span><span class="s2">) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>gameState = </span><span class="s17">'FAIL'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>playLoudFailSound();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span>speakFail();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>} </span><span class="s14">else</span><span class="s2"> {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s14">if</span><span class="s2">(kernels.filter(k =&gt; !k.isRotten &amp;&amp; !k.hasWorm &amp;&amp; !k.eaten).length === </span><span class="s15">0</span><span class="s2">) gameState = </span><span class="s17">'RESULT'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                        </span></span><span class="s14">else</span><span class="s2"> gameState = </span><span class="s17">'PLAY'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                    </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>} </span><span class="s14">else</span><span class="s2"> </span><span class="s14">if</span><span class="s2"> ([</span><span class="s17">'RESULT'</span><span class="s2">, </span><span class="s17">'FAIL'</span><span class="s2">, </span><span class="s17">'HIDDEN'</span><span class="s2">].includes(gameState)) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>pigeon.x = width/</span><span class="s15">2</span><span class="s2">; pigeon.y = height/</span><span class="s15">2</span><span class="s2"> + </span><span class="s15">200</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">function</span><span class="s2"> drawResult() {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.save();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">if</span><span class="s2">(gameState === </span><span class="s17">'HIDDEN'</span><span class="s2">) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">`hsla(</span><span class="s2">${</span><span class="s16">Date</span><span class="s2">.now()%</span><span class="s15">360</span><span class="s2">}</span><span class="s17">, 70%, 50%, 0.3)`</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillRect(</span><span class="s15">0</span><span class="s2">,</span><span class="s15">0</span><span class="s2">,width,height);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.fillStyle = </span><span class="s17">'rgba(255,255,255,0.98)'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.shadowBlur = </span><span class="s15">40</span><span class="s2">; ctx.shadowColor = </span><span class="s17">'rgba(0,0,0,0.3)'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> panelY = height/</span><span class="s15">2</span><span class="s2"> - </span><span class="s15">380</span><span class="s2">;<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">const</span><span class="s2"> shakeUI = (gameState === </span><span class="s17">'FAIL'</span><span class="s2"> || gameState === </span><span class="s17">'HIDDEN'</span><span class="s2"> ? </span><span class="s16">Math</span><span class="s2">.sin(</span><span class="s16">Date</span><span class="s2">.now()*</span><span class="s15">0.1</span><span class="s2">)*</span><span class="s15">12</span><span class="s2"> : </span><span class="s15">0</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.beginPath(); ctx.roundRect(width/</span><span class="s15">2</span><span class="s2"> - </span><span class="s15">300</span><span class="s2"> + shakeUI, panelY, </span><span class="s15">600</span><span class="s2">, </span><span class="s15">300</span><span class="s2">, </span><span class="s15">40</span><span class="s2">); ctx.fill();</span></p>
<p class="p6"><span class="s2"><span class="Apple-converted-space">            </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.textAlign = </span><span class="s17">'center'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">if</span><span class="s2">(gameState === </span><span class="s17">'RESULT'</span><span class="s2">) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">'#1e3799'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.font = </span><span class="s17">"900 52px Arial"</span><span class="s2">; ctx.fillText(</span><span class="s17">"</span><span class="s18">热舞霸主诞生</span><span class="s17">!"</span><span class="s2">, width/</span><span class="s15">2</span><span class="s2"> + shakeUI, panelY + </span><span class="s15">100</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">'#2ecc71'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.font = </span><span class="s17">"bold 90px Arial"</span><span class="s2">; ctx.fillText(</span><span class="s17">`</span><span class="s2">${score}</span><span class="s17">`</span><span class="s2">, width/</span><span class="s15">2</span><span class="s2"> + shakeUI, panelY + </span><span class="s15">200</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>} </span><span class="s14">else</span><span class="s2"> </span><span class="s14">if</span><span class="s2">(gameState === </span><span class="s17">'FAIL'</span><span class="s2">) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">'#c0392b'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.font = </span><span class="s17">"900 100px 'Microsoft YaHei'"</span><span class="s2">;<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillText(</span><span class="s17">"</span><span class="s18">你也太菜了</span><span class="s17">!"</span><span class="s2">, width/</span><span class="s15">2</span><span class="s2"> + shakeUI, panelY + </span><span class="s15">130</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">'#FF4757'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.font = </span><span class="s17">"bold 80px Arial"</span><span class="s2">; ctx.fillText(</span><span class="s17">`</span><span class="s2">${score}</span><span class="s17">`</span><span class="s2">, width/</span><span class="s15">2</span><span class="s2"> + shakeUI, panelY + </span><span class="s15">230</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>} </span><span class="s14">else</span><span class="s2"> </span><span class="s14">if</span><span class="s2">(gameState === </span><span class="s17">'HIDDEN'</span><span class="s2">) {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">'#8e44ad'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.font = </span><span class="s17">"900 65px Arial"</span><span class="s2">; ctx.fillText(</span><span class="s17">"</span><span class="s18">腐烂之王诞生</span><span class="s17">!"</span><span class="s2">, width/</span><span class="s15">2</span><span class="s2"> + shakeUI, panelY + </span><span class="s15">110</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.fillStyle = </span><span class="s17">'#f39c12'</span><span class="s2">;</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">                </span>ctx.font = </span><span class="s17">"bold 45px Arial"</span><span class="s2">; ctx.fillText(</span><span class="s17">"</span><span class="s18">运气也是实力的一种</span><span class="s17">!"</span><span class="s2">, width/</span><span class="s15">2</span><span class="s2"> + shakeUI, panelY + </span><span class="s15">200</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.font = </span><span class="s17">"24px Arial"</span><span class="s2">; ctx.fillStyle = </span><span class="s17">'#7f8c8d'</span><span class="s2">;<span class="Apple-converted-space"> </span></span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.fillText(</span><span class="s17">"</span><span class="s18">点击任何位置重启</span><span class="s17"> Funk </span><span class="s18">挑战</span><span class="s17">"</span><span class="s2">, width/</span><span class="s15">2</span><span class="s2"> + shakeUI, panelY + </span><span class="s15">275</span><span class="s2">);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.restore();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span></span><span class="s14">function</span><span class="s2"> loop() {</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>ctx.clearRect(</span><span class="s15">0</span><span class="s2">, </span><span class="s15">0</span><span class="s2">, width, height);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>drawCorn();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>update();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>drawPigeon(pigeon.x, pigeon.y, pigeon.angle, gameState);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span></span><span class="s14">if</span><span class="s2">([</span><span class="s17">'RESULT'</span><span class="s2">, </span><span class="s17">'FAIL'</span><span class="s2">, </span><span class="s17">'HIDDEN'</span><span class="s2">].includes(gameState)) drawResult();</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">            </span>requestAnimationFrame(loop);</span></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p6"><span class="s10"></span><br></p>
<p class="p4"><span class="s2"><span class="Apple-converted-space">        </span>loop();</span></p>
<p class="p1"><span class="s3"><span class="Apple-converted-space">    </span></span><span class="s1">&lt;/</span><span class="s2">script</span><span class="s1">&gt;</span></p>
<p class="p1"><span class="s1">&lt;/</span><span class="s2">body</span><span class="s1">&gt;</span></p>
<p class="p10"><span class="s10"></span><br></p>
</body>
</html>
